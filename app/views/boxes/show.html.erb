<h3><%= @box.title %></h3>
Created on: <%= @box.created_at.strftime("%m/%d/%y") %><br>
Subscription Level: <%= @box.subscription.level %><br>

Shipped On: <%= @box.updated_at.strftime("%m/%d/%y") %><br>
<p>
  <ul><strong>ITEMS:</strong> (<%= link_to "See item details", box_items_path(@box), :class => "load_items" %>)
    <% @box.items.each do |item| %>
      <li><%= item.title %> : <%= item.description %> (size: <%= item.size %>) | <%= link_to "edit", edit_box_item_path(@box, item) %> | <%= link_to "delete", [@box, item], :method => :delete %> Note: deleting is final!
      </li>
    <% end %>
  </ul>
</p>

<div class="items">
</div>

<p>
  <% if !@box.shipped %>
    <% if current_user.try(:admin?) %>
      <p><%= render 'items/form' %><p>
      <p>
      <mark>**This box has not yet been shipped.**</mark> - <%= link_to "Ready to ship?", edit_box_path %>
    </p>
    <% end %>
  <% end %>
</p>

<h5><%= link_to "Back to boxes", boxes_path %></h5>
<h5><%= link_to 'Next', @box.next if @box.next %></h5>

<script type="text/javascript" charset="utf-8">
  $(function() {
    $("a.load_items").on("click", function(e) {
      $.ajax({
        method: "GET",
        url: this.href
      }).done(function(response) {
        $("div.items").html(response);
      });
      e.preventDefault();
    });
  })
</script>
